\newmintedfile{xml}{frame=leftline,linenos}

\chapter{Contexte du stage}
\section{Logilab}
Logilab est une société de services d'une vingtaine de personnes créée en septembre 2000. Logilab a opté pour le modèle économique \textit{open source}. Logilab est spécialisée dans le développement de solutions informatiques principalement dans les domaines de gestion de connaissance et scientifique. Elle propose aussi du conseil et des formations couvrant de multiples sujets (Python, \glslink{xml}{XML}, conception orientée objet, C++, méthodes agiles, etc.).

Logilab contribue au Logiciel Libre et met plusieurs des ses développements sous la licence libre \glslink{lgpl}{LGPL}. Elle encourage ses employés à contribuer sur des projets libres et sponsorise plusieurs événements en relation avec le logiciel libre. Elle privilégie les solutions libres qui répondent aux besoins de l'utilisateur et offrent des garanties de stabilité. Elle privilégie Debian, la distribution de Linux non commerciale, qui est installée sur son parc informatique. Elle utilise majoritairement le langage Python pour le développement de ses outils. Logilab contribue à la communauté Python, co-organise la conférence annuelle EuroPython et a co-fondé Python Business Forum, une association européenne ayant pour objectif de promouvoir les utilisations de Python dans l'industrie.

Logilab est l'une des entreprises françaises expertes en langage Python et en web sémantique. En 2013, elle avait remporté le prix Stanford de l'innovation pour le projet Databnf réalisé pour le compte de la Bibliothèque nationale de France. Le même projet a aussi remporté le Trophée de l'Excellence « Data Intelligence », toutes catégories confondues, dans le cadre du salon Documation - MIS 2013\cite{dta}. Le projet a permet, en s’appuyant sur les technologies de web sémantique, d'exposer les catalogues de la Bibliothèque nationale de France. Dans le domaine scientifique, Logilab propose Simulagora, une plateforme de simulation de calcul scientifique dans les nuages.

Parmi les développement réalisé par Logilab et qui sont distribué sous licence libre on peut citer :
\begin{description}
\item[Pylint]\hfill\\ Un logiciel de vérification de code source et de la qualité du code pour le langage Python. Il utilise les recommandations officielles de style de la \glslink{pep}{PEP} ~8.
\item[CubicWeb]\hfill\\ Un framework web pour la réalisation d’applications web. Il supporte les standards du web sémantique.
\item[RQL]\hfill\\ \glslink{rql}{RQL} est Un langage de requête de haut niveau s’inspirant de langage SQL permettant d'interroger des sources de données.
\item[Mercurial] \hfill\\ plusieurs outils autour de logiciel de gestion de version Mercurial. Logilab propose Plusieurs extensions au logiciel et une application de revue de code pour les entrepôts Mercurial. 
\end{description}



\section{CubicWeb}
CubicWeb est un framework pour le développement d'applications du web sémantique écrit en langage Python. Son développement a commencé en 2001 et est utilisé pour l'intranet de Logilab. En octobre 2008, Logilab sort le framework sous la licence libre \glslink{lgpl}{LGPL}. En 2013, CubicWeb est lauréat du concours Dataconnexions 2013, organisé par Etalab\cite{etalab}.

Le framework permet à l'utilisateur de se concentrer sur le type de données manipulées par son application. Une fois le schéma de données est défini à l'aide de langage \glslink{yams}{YAMS}, CubicWeb génère des vues permettant de manipuler ces données avec différant types de formats (\glslink{html}{HTML}, \glslink{rdf}{RDF}, \glslink{json}{JSON}, \glslink{jsonld}{JSON-LD}, \glslink{xml}{XML}, etc.). CubicWeb supporte plusieurs sources de données comme les bases \glslink{sql}{SQL}, les annuaires \glslink{ldap}{LDAP}, les entrepôts de donnés Mercurial. Pour faciliter l'utilisation de CubicWeb dans le développement utilisant des méthodes agiles, CubicWeb fournit un outil pour réaliser la migration de l'application vers des versions plus récentes. Cet outil permet de changer le schéma de données à tout moment durant le développement de l'application.


Afin d'accélérer le développement d'une application, CubicWeb permet l'utilisation de composants appelés \emph{cubes}. Un cube est un composant CubicWeb fournissant une fonctionnalité. Plusieurs cubes peuvent être assemblés pour réaliser son application finale. Logilab avait développé un nombre important de cubes qui sont disponibles sous licence libre. Par exemple, une application web d'un blog peut utiliser le cube \textit{blog} qui fournit la fonctionnalité pour la rédaction de billets avec le cube \textit{comment} qui permet de rajouter des commentaires sur les billets. Toutes les fonctionnalités de l'application sont ainsi fournies par ces deux cubes. Il reste qu'à personnaliser les vues de ces cubes.

L'une des principales fonctionnalités de CubicWeb est son mécanisme de sélection des objets de l'application appelés \textit{appobjects} (vues, contrôleurs, services, etc.). Ces objets sont chargés au lancement de l'application et c'est le framework qui décide quel objet utiliser en fonction du contexte de la requête de l'utilisateur. Le framework se base sur le contexte pour attribuer des scores pour les \textit{appobjects} disponibles et pouvoir ainsi utiliser le meilleur adapté à la requête de l'utilisateur.  

\section{Pyramid-CubicWeb}
Un projet appelé Pyramid-Cubicweb est en développement depuis 2014 pour permettre de coupler CubicWeb avec le framework web Pyramid. Le but de ce projet est de remplacer Twisted pour servir les applications CubiccWeb. L'utilisation de Pyramid-CubicWeb permet aussi d'avoir accès aux fonctionnalités des deux framework. Logilab a commencé de migrer ces applications existantes pour utiliser Pyramid-CubicWeb.
 
\section{Architecture REST}
\begin{figure}
\centering
  \includegraphics[width=.6\textwidth]{tikz/rest.pdf}
  \caption{Un système respectant le style d'architecture REST}
  \label{fig:rest}
\end{figure}
\glslink{REST}{REST} (\textit{REpresentational State Transfer}) est un style d'architecture qui définit des contraintes pour les systèmes \glslink{hypermedia}{hypermédia} distribués. Il a été crée par Roy Fielding\footnote{L’un des principaux auteurs de la spécification \glslink{http}{HTTP} et membre fondateur de la fondation Apache} dans sa thèse de doctorat\cite{restthesise}. C'est le style adopté par plusieurs géant du web\footnote{comme Google, Facebook, Microsoft, .etc.} pour implanter leur services. 

REST définit six contraintes qui, si elle sont respectées, permettent d'avoir un système performant, scalable et fiable. Les six contraintes sont :

\begin{description}
\item[Client-Serveur]\hfill\\
Les responsabilités doivent être séparées entre le client et le serveur. Le serveur fournit une interface que le client peut utiliser. Cette contrainte permet aux deux d'évoluer indépendamment.

\item[Sans état]\hfill\\
C'est le client qui est responsable de stocker l'état de ses requêtes. La requête du client doit contenir toutes les informations nécessaires pour son exécution par le serveur. Cela permet d'avoir un système scalable. En effet en rajoutant un deuxième serveur, les requêtes des clients peuvent être partagés entre les deux serveurs d'une manière égale\footnote{Si l'état est stocké par le serveur, cet état doit être dupliqué sur chaque serveur.}.

\item[Mise en cache]\hfill\\
L'utilisation d'un cache pour ne pas renvoyer des données qui ont été déjà chargé par le client et n'ont pas changé. Cette contrainte permet d'améliorer les performances du système.

\item[Une interface uniforme]\hfill\\
Le serveur doit fournir au client une interface qui respecte les quatre règles suivantes :
\begin{itemize}
\item Chaque ressource doit avoir un identifiant
\item L'utilisation des représentations pour manipuler les ressources
\item Les requêtes et réponses sont auto-descriptifs
\item Hypermédia comme moteur d'état de l'application (\glslink{hateoas}{HATEOAS})	 
\end{itemize} 

\item[Un système hiérarchisé par couche]\hfill\\
Le système doit être hiérarchisé par couche et chaque couche a une responsabilité unique. Par exemple une couche peut avoir la responsabilité d'authentifier les clients et une autre peut offrir un cache. Cette contrainte permet l'évolution facile du système.

\item[Code à la demande]\hfill\\
Cette contrainte est optionnelle. Elle permet au serveur d'envoyer de code qui sera exécuté par le client. Cela permet d'améliorer les performances du système et permet au client d'évoluer au cours du temps.
\end{description}

En analysant ces contraintes, on trouve que le protocole \glslink{http}{HTTP} respecte bien le style d'architecture REST. Cela s'explique par le fait que Roy Fielding avait participé à l'écriture de ces spécifications et que REST est adapté au World Wide Web.  

Plusieurs services web REST sont apparus ces dernières années. Une grande partie des ces services ne respecte pas totalement l'architecture REST telle qu'elle est définie dans la thèse de de doctorat de Roy Fielding. C'est généralement la quatrième contrainte de l'interface uniforme qui n'est pas respectée. Normalement, lorsque cette contrainte est respectée, le client peut savoir tous les opérations qu'il peut effectuer sur les ressources. Ces opérations sont inclus dans la réponse de serveur. La figure ~\ref{fig:hateoas} montre un exemple incluant des liens permettant d'effectuer des opérations sur la ressource retournée. Dans l'exemple, la ressource retournée est un compte bancaire et on peut effectuer quatre opérations sur ce compte (dépôt, retrait, virement et fermeture). 


\begin{figure}[htp]
    \centering
    \RecustomVerbatimEnvironment{Verbatim}{BVerbatim}{}
        \xmlfile[firstline=1, lastline=13]{examples/examples.xml}
    \caption{Une réponse incluant les opérations possibles sur la ressource}
    \label{fig:hateoas}
\end{figure}



